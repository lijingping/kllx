{"version":3,"sources":["assets/Script/item/SkinItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Common_CommonUtil from \"../common/Common_CommonUtil\";\nimport ShareSdk = require('../common/ShareSdk');\nconst { ccclass, property } = cc._decorator;\ndeclare var window: any;\ndeclare var EVENT_LISTENER: any;\n@ccclass\nexport default class SkinItem extends cc.Component {\n\n    @property(cc.Label)\n    m_l_goldlabel: cc.Label = null;\n\n    @property(cc.Sprite)\n    m_sp_blockstyle: cc.Sprite = null;\n\n    @property(cc.Node)\n    m_n_isready: cc.Node = null;\n\n    @property(cc.Button)\n    m_btn_suitup: cc.Button = null;\n\n    @property(cc.Label)\n    m_l_sharetext: cc.Label = null;\n\n    private _data: any = null;\n    private _state: number = 0;\n    private _index: number = 0;\n    private _onshowback: boolean = false;\n\n    start() {\n        EVENT_LISTENER.on(window.ON_SHOW_BACK, this.onshowback, this);\n    }\n\n    onDestroy() {\n        EVENT_LISTENER.off(window.ON_SHOW_BACK, this);\n    }\n\n    updateData(index: number, data: any, sframe) {\n        this._index = index;\n        this._data = data;\n        let state = window.INIT_GAME_SAVE_DATA.skin[index];\n        this._state = state ? state : 0;\n        this.m_sp_blockstyle.spriteFrame = sframe;\n        this.m_n_isready.active = this._state >= 2;\n        this.m_btn_suitup.node.active = this._state < 2;\n        this.m_l_goldlabel.string = data.price;\n        if (this._state == 0) {//未获得\n            if (data.way == 1 && window.SKIN_SHARE) { //分享获得且开关开启\n                this.m_l_sharetext.node.active = true;\n                this.m_l_goldlabel.node.parent.active = false;\n                this.m_btn_suitup.interactable = true;\n            } else {\n                this.m_l_sharetext.node.active = false;\n                this.m_l_goldlabel.node.parent.active = true;\n                this.m_btn_suitup.interactable = window.INIT_GAME_SAVE_DATA.gold_num >= data.price;\n            }\n            this.m_btn_suitup.node.y = -145;\n        } else if (this._state == 1) {\n            this.m_l_sharetext.node.active = false;\n            this.m_l_goldlabel.node.parent.active = false;\n            this.m_btn_suitup.interactable = true;\n            this.m_btn_suitup.node.y = -74;\n        } else {\n            this.m_l_sharetext.node.active = false;\n            this.m_l_goldlabel.node.parent.active = false;\n        }\n    }\n\n    onshowback(time) {\n        if (this._onshowback) {\n            if (time >= window.SHARE_TIME) {\n                this.onSuitUp();\n            } else {\n                Common_CommonUtil.showShareFailTips();\n            }\n            this._onshowback = false;\n        }\n    }\n\n    onSuitUp() {\n        if (!this.m_btn_suitup.interactable) return;\n        let skin_config = window.INIT_GAME_SAVE_DATA.skin;\n        for (let i = 0; i < skin_config.length; i++) {\n            if (skin_config[i] == 2) {\n                window.INIT_GAME_SAVE_DATA.skin[i] = 1;\n                window.INIT_GAME_SAVE_DATA.skin[this._index] = 2;\n                break;\n            }\n        }\n        if (this._state == 0) {\n            if (this._data.way == 0 || !window.SKIN_SHARE) {\n                window.INIT_GAME_SAVE_DATA.gold_num -= this._data.price;\n                EVENT_LISTENER.fire(window.GAME_UPDATE_DATA);\n            }else{\n                this._onshowback = true;\n                ShareSdk.shareAppMessage({\n                    title: \"获得了一个怪兽皮肤，快来看看吧\",\n                    imageUrl: window.tempFileURL[1],\n                })\n            }\n        }\n        // console.log(window.INIT_GAME_SAVE_DATA.skin)\n        EVENT_LISTENER.fire(window.GAME_SAVE_HANDLER);\n    }\n\n}\n"]}