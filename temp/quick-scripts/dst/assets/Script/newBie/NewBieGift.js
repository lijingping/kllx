
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/newBie/NewBieGift.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ff138Fh57NHHqstEbjYQe72', 'NewBieGift');
// Script/newBie/NewBieGift.js

"use strict";

var Utils = require("Utils");

var ShareSdk = require("ShareSdk");

var GetTimeString = function GetTimeString() {
  var data = new Date();
  var time = data.getFullYear() + "/" + (data.getMonth() + 1) + "/" + data.getDate(); // var time = data.toLocaleDateString();

  var arr = time.split("/");
  return [time, arr];
};

cc.Class({
  "extends": cc.Component,
  properties: {
    m_n_newpanel: cc.Node,
    m_n_newpanel_success: cc.Node,
    m_btn_getreward: cc.Button,
    m_l_desc: cc.Label
  },
  // LIFE-CYCLE CALLBACKS:
  // onLoad () {},
  start: function start() {
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false; // EVENT_LISTENER.on(window.GAME_SAVE_HANDLER, this.updateData, this);

    EVENT_LISTENER.on(window.ON_SHOW_BACK, this.onshowback, this);
    this.updateData();
  },
  // update (dt) {},
  onEnable: function onEnable() {},
  onDisable: function onDisable() {},
  onDestroy: function onDestroy() {
    // EVENT_LISTENER.off(window.GAME_SAVE_HANDLER, this);
    EVENT_LISTENER.off(window.ON_SHOW_BACK, this);
  },
  onshowback: function onshowback(time) {
    if (this._onshowback) {
      this._onshowback = false;

      if (this.m_n_newpanel_success.active) {
        this.m_n_newpanel_success.active = false;
      }
    }
  },
  autoShowRewardPage: function autoShowRewardPage() {
    // 上次领取的时间
    var state = this.getState();

    if (state == 1) {
      if (!window.firststart) {
        this.onBtnNewBieClick();
        window.firststart = true;
      }
    }
  },
  getState: function getState() {
    var state = 1;
    var getTime = window.INIT_GAME_SAVE_DATA.login_time; // console.log("getstate",getTime)

    if (getTime && getTime != 'null' && getTime != '') {
      var getArr = getTime.split("/");
      var temp = GetTimeString();
      var curTime = temp[0],
          curArr = temp[1]; // console.log(getArr, temp[1])

      state = this.judgeTime(getArr, curArr);
    }

    return state;
  },
  judgeTime: function judgeTime(t_a1, t_a2) {
    if (parseInt(t_a1[0]) < parseInt(t_a2[0])) return 1;
    if (parseInt(t_a1[0]) > parseInt(t_a2[0])) return -1;
    if (parseInt(t_a1[1]) < parseInt(t_a2[1])) return 1;
    if (parseInt(t_a1[1]) > parseInt(t_a2[1])) return -1;
    var res = 0;
    if (parseInt(t_a1[2]) < parseInt(t_a2[2])) res = 1;else if (parseInt(t_a1[2]) > parseInt(t_a2[2])) res = -1;
    return res;
  },
  updateData: function updateData() {
    // let state = window.INIT_GAME_SAVE_DATA.award_list % 10;
    // let tt = this.m_btn_getreward.node.getChildByName("l_newbconfirm");
    this.autoShowRewardPage();
    var state = this.getState();

    if (state == 1) {
      // this.m_btn_getreward.interactable = true;
      this.m_l_desc.string = "每天可领一次";
    } else {
      // this.m_btn_getreward.interactable = false;
      this.m_l_desc.string = "每天可领一次(已领取)";
    }

    this.m_btn_getreward.node.active = state == 1;
  },
  onBtnNewBieClick: function onBtnNewBieClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = true; // let tt = this.m_btn_getreward.node.getChildByName("l_newbconfirm");

    var state = this.getState();

    if (state == 1) {
      // this.m_btn_getreward.interactable = true;
      this.m_l_desc.string = "每天可领一次";
    } else {
      // this.m_btn_getreward.interactable = false;
      this.m_l_desc.string = "每天可领一次(已领取)";
    }

    this.m_btn_getreward.node.active = state == 1;
  },
  onBackBtnClick: function onBackBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false;
  },
  onRewardBackBtnClick: function onRewardBackBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = false;
  },
  onBtnGetRewardClick: function onBtnGetRewardClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    this.m_n_newpanel.active = false;
    this.m_n_newpanel_success.active = true;
    var temp = GetTimeString();
    var curTime = temp[0];
    this._onshowback = true;
    window.INIT_GAME_SAVE_DATA.login_time = curTime;
    window.INIT_GAME_SAVE_DATA.tool[0] += 1;
    window.INIT_GAME_SAVE_DATA.gold_num += 10;
    this.updateData();
    if (window.GAME_MENU) window.GAME_MENU.updateGold();
  },
  onShareBtnClick: function onShareBtnClick() {
    Utils.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);
    var self = this;
    ShareSdk.shareAppMessage({
      title: "炸弹，金币每天领，快来领取吧",
      imageUrl: window.tempFileURL[0],
      success: function success(res) {
        // cc.director.loadScene(window.GAME_SCENE_NAME);
        self.m_n_sharenode.active = true;
      },
      fail: function fail(err) {},
      complate: function complate(msg) {}
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvbmV3QmllL05ld0JpZUdpZnQuanMiXSwibmFtZXMiOlsiVXRpbHMiLCJyZXF1aXJlIiwiU2hhcmVTZGsiLCJHZXRUaW1lU3RyaW5nIiwiZGF0YSIsIkRhdGUiLCJ0aW1lIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJhcnIiLCJzcGxpdCIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibV9uX25ld3BhbmVsIiwiTm9kZSIsIm1fbl9uZXdwYW5lbF9zdWNjZXNzIiwibV9idG5fZ2V0cmV3YXJkIiwiQnV0dG9uIiwibV9sX2Rlc2MiLCJMYWJlbCIsInN0YXJ0IiwiYWN0aXZlIiwiRVZFTlRfTElTVEVORVIiLCJvbiIsIndpbmRvdyIsIk9OX1NIT1dfQkFDSyIsIm9uc2hvd2JhY2siLCJ1cGRhdGVEYXRhIiwib25FbmFibGUiLCJvbkRpc2FibGUiLCJvbkRlc3Ryb3kiLCJvZmYiLCJfb25zaG93YmFjayIsImF1dG9TaG93UmV3YXJkUGFnZSIsInN0YXRlIiwiZ2V0U3RhdGUiLCJmaXJzdHN0YXJ0Iiwib25CdG5OZXdCaWVDbGljayIsImdldFRpbWUiLCJJTklUX0dBTUVfU0FWRV9EQVRBIiwibG9naW5fdGltZSIsImdldEFyciIsInRlbXAiLCJjdXJUaW1lIiwiY3VyQXJyIiwianVkZ2VUaW1lIiwidF9hMSIsInRfYTIiLCJwYXJzZUludCIsInJlcyIsInN0cmluZyIsIm5vZGUiLCJTZXRTb3VuZEVmZmVjdCIsIkJVVFRPTl9DTElDS19NVVNJQyIsIm9uQmFja0J0bkNsaWNrIiwib25SZXdhcmRCYWNrQnRuQ2xpY2siLCJvbkJ0bkdldFJld2FyZENsaWNrIiwidG9vbCIsImdvbGRfbnVtIiwiR0FNRV9NRU5VIiwidXBkYXRlR29sZCIsIm9uU2hhcmVCdG5DbGljayIsInNlbGYiLCJzaGFyZUFwcE1lc3NhZ2UiLCJ0aXRsZSIsImltYWdlVXJsIiwidGVtcEZpbGVVUkwiLCJzdWNjZXNzIiwi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Q0FBQ21DLFNBQVAsQ0FBaUJDLFVBQWpCO0FBQ1AsR0FsSkk7QUFvSkxDLEVBQUFBLGVBcEpLLDZCQW9KYTtBQUNkaEUsSUFBQUEsS0FBSyxDQUFDdUQsY0FBTixDQUFxQjVCLE1BQU0sQ0FBQzZCLGtCQUE1QixFQUFnRCxLQUFoRCxFQUF1RCxDQUF2RDtBQUNBLFFBQUlTLElBQUksR0FBRyxJQUFYO0FBQ0EvRCxJQUFBQSxRQUFRLENBQUNnRSxlQUFULENBQXlCO0FBQ3JCQyxNQUFBQSxLQUFLLEVBQUUsZ0JBRGM7QUFFckJDLE1BQUFBLFFBQVEsRUFBRXpDLE1BQU0sQ0FBQzBDLFdBQVAsQ0FBbUIsQ0FBbkIsQ0FGVztBQUdyQkMsTUFBQUEsT0FBTyxFQUFFLGlCQUFBbEIsR0FBRyxFQUFJO0FBQ1o7QUFDQWEsUUFBQUEsSUFBSSxDQUFDTSxhQUFMLENBQW1CL0MsTUFBbkIsR0FBNEIsSUFBNUI7QUFDSCxPQU5vQjtBQU9yQmdELE1BQUFBLElBQUksRUFBRSxjQUFBQyxHQUFHLEVBQUksQ0FFWixDQVRvQjtBQVVyQkMsTUFBQUEsUUFBUSxFQUFFLGtCQUFBQyxHQUFHLEVBQUksQ0FFaEI7QUFab0IsS0FBekI7QUFjSDtBQXJLSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgVXRpbHMgPSByZXF1aXJlKFwiVXRpbHNcIik7XG52YXIgU2hhcmVTZGsgPSByZXF1aXJlKFwiU2hhcmVTZGtcIik7XG52YXIgR2V0VGltZVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IG5ldyBEYXRlKClcbiAgICB2YXIgdGltZSA9IGRhdGEuZ2V0RnVsbFllYXIoKSArIFwiL1wiICsgKGRhdGEuZ2V0TW9udGgoKSArIDEpICsgXCIvXCIgKyBkYXRhLmdldERhdGUoKTtcbiAgICAvLyB2YXIgdGltZSA9IGRhdGEudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gICAgbGV0IGFyciA9IHRpbWUuc3BsaXQoXCIvXCIpO1xuICAgIHJldHVybiBbdGltZSwgYXJyXTtcbn07XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtX25fbmV3cGFuZWw6IGNjLk5vZGUsXG4gICAgICAgIG1fbl9uZXdwYW5lbF9zdWNjZXNzOiBjYy5Ob2RlLFxuICAgICAgICBtX2J0bl9nZXRyZXdhcmQ6IGNjLkJ1dHRvbixcbiAgICAgICAgbV9sX2Rlc2M6IGNjLkxhYmVsLFxuICAgIH0sXG5cbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcblxuICAgIC8vIG9uTG9hZCAoKSB7fSxcblxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWxfc3VjY2Vzcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgLy8gRVZFTlRfTElTVEVORVIub24od2luZG93LkdBTUVfU0FWRV9IQU5ETEVSLCB0aGlzLnVwZGF0ZURhdGEsIHRoaXMpO1xuICAgICAgICBFVkVOVF9MSVNURU5FUi5vbih3aW5kb3cuT05fU0hPV19CQUNLLCB0aGlzLm9uc2hvd2JhY2ssIHRoaXMpO1xuICAgICAgICB0aGlzLnVwZGF0ZURhdGEoKTtcbiAgICB9LFxuXG4gICAgLy8gdXBkYXRlIChkdCkge30sXG4gICAgb25FbmFibGUoKSB7XG5cbiAgICB9LFxuXG4gICAgb25EaXNhYmxlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgb25EZXN0cm95KCkge1xuICAgICAgICAvLyBFVkVOVF9MSVNURU5FUi5vZmYod2luZG93LkdBTUVfU0FWRV9IQU5ETEVSLCB0aGlzKTtcbiAgICAgICAgRVZFTlRfTElTVEVORVIub2ZmKHdpbmRvdy5PTl9TSE9XX0JBQ0ssIHRoaXMpO1xuICAgIH0sXG5cbiAgICBvbnNob3diYWNrKHRpbWUpIHtcbiAgICAgICAgaWYgKHRoaXMuX29uc2hvd2JhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uc2hvd2JhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbl9uZXdwYW5lbF9zdWNjZXNzLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubV9uX25ld3BhbmVsX3N1Y2Nlc3MuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYXV0b1Nob3dSZXdhcmRQYWdlKCkge1xuICAgICAgICAvLyDkuIrmrKHpooblj5bnmoTml7bpl7RcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICBpZiAoc3RhdGUgPT0gMSkge1xuICAgICAgICAgICAgaWYgKCF3aW5kb3cuZmlyc3RzdGFydCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25CdG5OZXdCaWVDbGljaygpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5maXJzdHN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRTdGF0ZSgpIHtcbiAgICAgICAgdmFyIHN0YXRlID0gMTtcblxuICAgICAgICB2YXIgZ2V0VGltZSA9IHdpbmRvdy5JTklUX0dBTUVfU0FWRV9EQVRBLmxvZ2luX3RpbWU7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2V0c3RhdGVcIixnZXRUaW1lKVxuICAgICAgICBpZiAoZ2V0VGltZSAmJiBnZXRUaW1lICE9ICdudWxsJyAmJiBnZXRUaW1lICE9ICcnKSB7XG4gICAgICAgICAgICB2YXIgZ2V0QXJyID0gZ2V0VGltZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IEdldFRpbWVTdHJpbmcoKTtcbiAgICAgICAgICAgIHZhciBjdXJUaW1lID0gdGVtcFswXSwgY3VyQXJyID0gdGVtcFsxXVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZ2V0QXJyLCB0ZW1wWzFdKVxuICAgICAgICAgICAgc3RhdGUgPSB0aGlzLmp1ZGdlVGltZShnZXRBcnIsIGN1ckFycilcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfSxcblxuICAgIGp1ZGdlVGltZTogZnVuY3Rpb24gKHRfYTEsIHRfYTIpIHtcbiAgICAgICAgaWYgKHBhcnNlSW50KHRfYTFbMF0pIDwgcGFyc2VJbnQodF9hMlswXSkpXG4gICAgICAgICAgICByZXR1cm4gMVxuICAgICAgICBpZiAocGFyc2VJbnQodF9hMVswXSkgPiBwYXJzZUludCh0X2EyWzBdKSlcbiAgICAgICAgICAgIHJldHVybiAtMVxuICAgICAgICBpZiAocGFyc2VJbnQodF9hMVsxXSkgPCBwYXJzZUludCh0X2EyWzFdKSlcbiAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgIGlmIChwYXJzZUludCh0X2ExWzFdKSA+IHBhcnNlSW50KHRfYTJbMV0pKVxuICAgICAgICAgICAgcmV0dXJuIC0xXG4gICAgICAgIGxldCByZXMgPSAwXG4gICAgICAgIGlmIChwYXJzZUludCh0X2ExWzJdKSA8IHBhcnNlSW50KHRfYTJbMl0pKVxuICAgICAgICAgICAgcmVzID0gMVxuICAgICAgICBlbHNlIGlmIChwYXJzZUludCh0X2ExWzJdKSA+IHBhcnNlSW50KHRfYTJbMl0pKVxuICAgICAgICAgICAgcmVzID0gLTFcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgIH0sXG5cbiAgICB1cGRhdGVEYXRhKCkge1xuICAgICAgICAvLyBsZXQgc3RhdGUgPSB3aW5kb3cuSU5JVF9HQU1FX1NBVkVfREFUQS5hd2FyZF9saXN0ICUgMTA7XG4gICAgICAgIC8vIGxldCB0dCA9IHRoaXMubV9idG5fZ2V0cmV3YXJkLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsX25ld2Jjb25maXJtXCIpO1xuICAgICAgICB0aGlzLmF1dG9TaG93UmV3YXJkUGFnZSgpO1xuICAgICAgICBsZXQgc3RhdGUgPSB0aGlzLmdldFN0YXRlKCk7XG4gICAgICAgIGlmIChzdGF0ZSA9PSAxKSB7XG4gICAgICAgICAgICAvLyB0aGlzLm1fYnRuX2dldHJld2FyZC5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tX2xfZGVzYy5zdHJpbmcgPSBcIuavj+WkqeWPr+mihuS4gOasoVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gdGhpcy5tX2J0bl9nZXRyZXdhcmQuaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm1fbF9kZXNjLnN0cmluZyA9IFwi5q+P5aSp5Y+v6aKG5LiA5qyhKOW3sumihuWPlilcIjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1fYnRuX2dldHJld2FyZC5ub2RlLmFjdGl2ZSA9IChzdGF0ZSA9PSAxKTtcbiAgICB9LFxuXG4gICAgb25CdG5OZXdCaWVDbGljaygpIHtcbiAgICAgICAgVXRpbHMuU2V0U291bmRFZmZlY3Qod2luZG93LkJVVFRPTl9DTElDS19NVVNJQywgZmFsc2UsIDEpO1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvLyBsZXQgdHQgPSB0aGlzLm1fYnRuX2dldHJld2FyZC5ub2RlLmdldENoaWxkQnlOYW1lKFwibF9uZXdiY29uZmlybVwiKTtcbiAgICAgICAgbGV0IHN0YXRlID0gdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICBpZiAoc3RhdGUgPT0gMSkge1xuICAgICAgICAgICAgLy8gdGhpcy5tX2J0bl9nZXRyZXdhcmQuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubV9sX2Rlc2Muc3RyaW5nID0gXCLmr4/lpKnlj6/poobkuIDmrKFcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHRoaXMubV9idG5fZ2V0cmV3YXJkLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5tX2xfZGVzYy5zdHJpbmcgPSBcIuavj+WkqeWPr+mihuS4gOasoSjlt7Lpooblj5YpXCI7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm1fYnRuX2dldHJld2FyZC5ub2RlLmFjdGl2ZSA9IChzdGF0ZSA9PSAxKTtcbiAgICB9LFxuXG4gICAgb25CYWNrQnRuQ2xpY2soKSB7XG4gICAgICAgIFV0aWxzLlNldFNvdW5kRWZmZWN0KHdpbmRvdy5CVVRUT05fQ0xJQ0tfTVVTSUMsIGZhbHNlLCAxKTtcbiAgICAgICAgdGhpcy5tX25fbmV3cGFuZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsX3N1Y2Nlc3MuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uUmV3YXJkQmFja0J0bkNsaWNrKCkge1xuICAgICAgICBVdGlscy5TZXRTb3VuZEVmZmVjdCh3aW5kb3cuQlVUVE9OX0NMSUNLX01VU0lDLCBmYWxzZSwgMSk7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbF9zdWNjZXNzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBvbkJ0bkdldFJld2FyZENsaWNrKCkge1xuICAgICAgICBVdGlscy5TZXRTb3VuZEVmZmVjdCh3aW5kb3cuQlVUVE9OX0NMSUNLX01VU0lDLCBmYWxzZSwgMSk7XG4gICAgICAgIHRoaXMubV9uX25ld3BhbmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1fbl9uZXdwYW5lbF9zdWNjZXNzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciB0ZW1wID0gR2V0VGltZVN0cmluZygpO1xuICAgICAgICB2YXIgY3VyVGltZSA9IHRlbXBbMF07XG4gICAgICAgIHRoaXMuX29uc2hvd2JhY2sgPSB0cnVlO1xuICAgICAgICB3aW5kb3cuSU5JVF9HQU1FX1NBVkVfREFUQS5sb2dpbl90aW1lID0gY3VyVGltZTtcblxuICAgICAgICB3aW5kb3cuSU5JVF9HQU1FX1NBVkVfREFUQS50b29sWzBdICs9IDE7XG4gICAgICAgIHdpbmRvdy5JTklUX0dBTUVfU0FWRV9EQVRBLmdvbGRfbnVtICs9IDEwO1xuXG4gICAgICAgIHRoaXMudXBkYXRlRGF0YSgpO1xuICAgICAgICBpZiAod2luZG93LkdBTUVfTUVOVSlcbiAgICAgICAgICAgIHdpbmRvdy5HQU1FX01FTlUudXBkYXRlR29sZCgpO1xuICAgIH0sXG5cbiAgICBvblNoYXJlQnRuQ2xpY2soKSB7XG4gICAgICAgIFV0aWxzLlNldFNvdW5kRWZmZWN0KHdpbmRvdy5CVVRUT05fQ0xJQ0tfTVVTSUMsIGZhbHNlLCAxKTtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICBTaGFyZVNkay5zaGFyZUFwcE1lc3NhZ2Uoe1xuICAgICAgICAgICAgdGl0bGU6IFwi54K45by577yM6YeR5biB5q+P5aSp6aKG77yM5b+r5p2l6aKG5Y+W5ZCnXCIsXG4gICAgICAgICAgICBpbWFnZVVybDogd2luZG93LnRlbXBGaWxlVVJMWzBdLFxuICAgICAgICAgICAgc3VjY2VzczogcmVzID0+IHtcbiAgICAgICAgICAgICAgICAvLyBjYy5kaXJlY3Rvci5sb2FkU2NlbmUod2luZG93LkdBTUVfU0NFTkVfTkFNRSk7XG4gICAgICAgICAgICAgICAgc2VsZi5tX25fc2hhcmVub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFpbDogZXJyID0+IHtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsYXRlOiBtc2cgPT4ge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9LFxufSk7XG4iXX0=