{"version":3,"sources":["assets/Script/item/StepViewItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Common_CommonUtil from \"../common/Common_CommonUtil\";\nimport Utils = require(\"../common/Utils\");\nimport ShareSDk = require(\"../common/ShareSdk\");\nconst { ccclass, property } = cc._decorator;\ndeclare var window: any;\ndeclare var EVENT_LISTENER: any;\n@ccclass\nexport default class StepViewItem extends cc.Component {\n    // onLoad () {}\n    private _callback = null;\n\n    @property(cc.Sprite)\n    m_sp_stepicon: cc.Sprite = null;\n\n    @property(cc.Sprite)\n    m_sp_stepname: cc.Sprite = null;\n\n    @property([cc.Node])\n    m_n_starlist: cc.Node[] = [];\n\n    @property(cc.Node)\n    m_n_bg: cc.Node = null;\n\n    @property(cc.Label)\n    m_l_steptitle: cc.Label = null;\n\n    @property(cc.SpriteAtlas)\n    m_spa_list: cc.SpriteAtlas = null;\n\n    private _stepname = \"\";\n    private _onshowback: boolean = false;\n    start() {\n        EVENT_LISTENER.on(window.ON_SHOW_BACK, this.onshowback, this);\n    }\n\n    onDestroy() {\n        EVENT_LISTENER.off(window.ON_SHOW_BACK, this);\n    }\n\n    setCloseCallback(callback) {\n        this._callback = callback;\n    }\n\n    onClose() {\n        if (this._callback) this._callback();\n        this.node.active = false;\n    }\n\n    onshowback(time) {\n        if (this._onshowback) {\n            this._onshowback = false;\n            this.onClose();\n        }\n    }\n\n    /**\n     * 显示获得段位信息\n     * @param lv 等级\n     */\n    showStep(lv: number) {\n        let num = this.updateData(lv);\n        for (let i = 0; i < this.m_n_starlist.length; i++) {\n            this.m_n_starlist[i].active = false;\n        }\n        this.m_sp_stepicon.node.getComponent(cc.Animation).play('playstep');\n        this.m_sp_stepname.node.getComponent(cc.Animation).play('playstep');\n        this.scheduleOnce(() => {\n            Common_CommonUtil.shakeScreen(this.m_n_bg);\n        }, 0.4);\n        for (let i = 0; i < num; i++) {\n            this.m_n_starlist[i].active = true;\n            this.m_n_starlist[i].scale = 0;\n            this.scheduleOnce(() => {\n                this.m_n_starlist[i].runAction(cc.sequence(cc.scaleTo(0.2, 1.4, 1.4).easing(cc.easeIn(3.0)), cc.scaleTo(0.1, 1, 1)));\n                Utils.SetSoundEffect(window.GET_GOLD, false, 1);\n            }, 0.54 + (i + 1) * 0.3);\n        }\n    }\n\n    updateData(lv: number = 0): number {\n        let index = Math.floor(lv / 10);\n        let stepdata = window.STEP_CONFIG[index - 1];\n        let num = 0;\n        if (stepdata) {\n            num = stepdata.star;\n            this._stepname = stepdata.desc;\n            this.m_l_steptitle.string = cc.js.formatStr(\"完成%d关 段位提升\", lv);\n            this.m_sp_stepicon.spriteFrame = this.m_spa_list.getSpriteFrame(stepdata.icon_path);\n            this.m_sp_stepname.spriteFrame = this.m_spa_list.getSpriteFrame(stepdata.desc_path);\n        }\n        return num;\n    }\n\n    setShowBtnVisible(boo) {\n        for (let i = 0; i < this.m_n_starlist.length; i++) {\n            this.m_n_starlist[i].active = boo;\n        }\n        this.m_sp_stepicon.node.active = boo;\n        this.m_sp_stepname.node.active = boo;\n    }\n\n    onShareStep() {\n        this._onshowback = true;\n        ShareSDk.shareAppMessage({\n            title: \"消除段位升级到【\" + this._stepname + \"】,一起来见证吧\",\n            imageUrl: window.tempFileURL[1],\n        });\n    }\n\n    // update (dt) {}\n}\n"]}