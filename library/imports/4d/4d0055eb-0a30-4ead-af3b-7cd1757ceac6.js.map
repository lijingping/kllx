{"version":3,"sources":["assets/Script/common/ReliveViewCtrl.js"],"names":["cc","Class","Component","properties","Score","Label","TimeTex","m_cost_numlabel","TimeNum","skipBtn","Node","m_cost_pic","Sprite","m_bg","m_share_relive","m_btn_share","Button","m_sp_all_gold","m_l_all_gold","start","node","zindex","string","timeOut","m_cost_num","window","RELIVE_COST_NUM","size","winSize","width","height","self","loader","loadRes","RELIVE_COST_PIC_PATH","SpriteFrame","err","spriteFrame","error","message","INIT_GAME_SAVE_DATA","gold_num","isWeChatPlatform","setShareReliveShow","SHARE_RELIVE","boo","active","setCallBackObj","obj","callbackobj","ShowView","IsShow","shareObj","is_share_relive","interactable","destroy","CountDownClick","time","schedule","DeleteTimeNum","onSkipCallBack","CoinBtnClick","relive","onCostRelive","setScoreLabel","score","setCostNumLabel","costnum","parseInt","ShareBtnClick","unschedule","wx","Data","share","EChannelPrefix","resurrection","res","shareTickets","success","Utils","showTipsText","fail","complete","cancelBtnClick"],"mappings":"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","sourceRoot":"/","sourcesContent":["// import dataStatistics from '../dataStatistics/dataStatistics';\nimport Data from '../dataStatistics/Data';\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        Score: cc.Label,\n        TimeTex: cc.Label,\n        m_cost_numlabel: cc.Label,\n        TimeNum: null,\n        skipBtn: cc.Node,           //跳过按键\n        m_cost_pic: cc.Sprite,\n        //game\n        m_bg: cc.Node,\n        m_share_relive: cc.Node,\n        m_btn_share: cc.Button,\n        m_sp_all_gold: cc.Sprite,\n        m_l_all_gold: cc.Label,\n    },\n\n    start() {\n        this.node.zindex = 100;    //设置z轴的位置\n        this.TimeNum = 10;\n        this.TimeTex.string = this.TimeNum;\n        this.timeOut = false;\n        // this.callbackobj = null;\n        this.m_cost_num = window.RELIVE_COST_NUM;\n        //设置节点的分辨率\n        var size = cc.winSize\n        this.m_bg.width = size.width;\n        this.m_bg.height = size.height;\n        let self = this;\n        cc.loader.loadRes(window.RELIVE_COST_PIC_PATH, cc.SpriteFrame, function (err, spriteFrame) {\n            if (err) {\n                cc.error(err.message || err);\n                return;\n            }\n            self.m_cost_pic.spriteFrame = spriteFrame;\n            self.m_sp_all_gold.spriteFrame = spriteFrame;\n        });\n        this.m_cost_numlabel.string = 'x' + window.RELIVE_COST_NUM;\n        this.m_l_all_gold.string = ':' + window.INIT_GAME_SAVE_DATA.gold_num;\n        if (window.isWeChatPlatform) {\n            // dataStatistics.getGameConfigByAppkey(res => {\n            //     console.log(res);\n            //     let share = res.data.data.share;\n            //     self.setShareReliveShow(share);\n            // });\n            self.setShareReliveShow(window.SHARE_RELIVE);\n        }\n    },\n\n\n    setShareReliveShow(boo) {\n        if (boo == 0) {\n            this.m_share_relive.active = false;\n        }\n        else {\n            this.m_share_relive.active = true;\n        }\n    },\n    setCallBackObj(obj) {\n        this.callbackobj = obj;\n    },\n\n    //分享视图显示\n    ShowView: function (IsShow) {\n        this.node.active = IsShow;\n        if (IsShow === true && this.callbackobj && this.callbackobj.shareObj) {\n            if (this.callbackobj.shareObj.is_share_relive) {\n                this.m_btn_share.interactable = false;\n            } else {\n                this.m_btn_share.interactable = true;\n            }\n        }\n        if (IsShow === false) {\n            // this.unschedule(this.DeleteTimeNum, this);\n            this.node.destroy();\n        }\n    },\n\n    //10秒倒计时 选择时间\n    CountDownClick: function (time) {\n        this.schedule(this.DeleteTimeNum, 1, time, 0, true);\n    },\n\n    DeleteTimeNum: function () {\n        this.TimeNum -= 1;\n        this.TimeTex.string = this.TimeNum;\n\n        //倒计时完成\n        if (this.TimeNum <= -1) {\n            this.TimeTex.string = 0;\n            this.ShowView(false);\n            if (this.callbackobj != null) {\n                this.callbackobj.onSkipCallBack();\n            }\n        }\n    },\n\n    //点击分享 游戏继续\n    CoinBtnClick: function () {\n        if (this.callbackobj != null) {\n            let relive = this.callbackobj.onCostRelive(this.m_cost_num);\n            if (relive) {\n                this.ShowView(false);\n            }\n        }\n    },\n\n    setScoreLabel: function (score) {\n        this.Score.string = score + \"\";\n    },\n\n    setCostNumLabel: function (costnum) {\n        this.m_cost_numlabel.string = \"x\" + costnum;\n        this.m_cost_num = parseInt(costnum);\n    },\n    //点击分享 游戏继续\n    ShareBtnClick: function () {\n        this.unschedule(this.DeleteTimeNum);\n\n        if (!window.wx) {\n            // console.log(\"=================不是微信平台===========\");\n            return;\n        }\n        var self = this;\n        if (this.callbackobj != null) {\n            var shareObj = this.callbackobj.shareObj;\n            Data.share(EChannelPrefix.resurrection, \"\", null, (res) => {\n                if (res.shareTickets) {\n                    if (shareObj.success)\n                        shareObj.success(res);\n                    self.ShowView(false);\n                } else {\n                    Utils.showTipsText(\"分享失败，请分享到群\", null, 0, 0, 80);\n                }\n            }, () => {\n                if (shareObj.fail)\n                    shareObj.fail();\n            }, () => {\n                if (shareObj.complete)\n                    shareObj.complete();\n            });\n        }\n    },\n    //点击跳过 直接游戏结束\n    cancelBtnClick: function () {\n        // console.log(\"cancelBtnClick\");\n        this.unschedule(this.DeleteTimeNum);\n        this.ShowView(false);\n        if (this.callbackobj != null) {\n            this.callbackobj.onSkipCallBack();\n        }\n    },\n});\n"]}