{"version":3,"sources":["assets/Script/common/Common_CommonUtil.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nexport default class Common_CommonUtil {\n\n    static isWeChat(): boolean {\n        return cc.sys.platform == cc.sys.WECHAT_GAME;\n    }\n\n    static showTips(content, hideCallback) {\n        cc.loader.loadRes(\"common/prefabs/h5game_Tips\", (err, prefab) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            var obj = cc.instantiate(prefab);\n            obj.getComponent(\"h5game_Tips\").setText(content, hideCallback);\n            obj.parent = cc.director.getScene();\n            //obj.position = cc.v2(0,0);\n        });\n    }\n\n    static showShareFailTips() {\n        Common_CommonUtil.getPrefab(\"prefabs/n_sharebubble\", (obj) => {\n            obj.parent = cc.find(\"Canvas\") || cc.director.getScene().children[0];\n            obj.zIndex = 1 << 11;\n        })\n    }\n    \n    static shakeScreen(targetNode, deltaTime: number = 0.02, offset: number = 10) {\n        var camera = targetNode;\n        camera.stopAllActions();\n        //camera.position = cc.Vec2.ZERO;\n        camera.runAction(\n            cc.sequence(\n                cc.moveBy(deltaTime, cc.v2(offset * 2, 0)),\n                cc.moveBy(deltaTime * 2, cc.v2(-offset * 4)),\n                cc.moveBy(deltaTime, cc.v2(offset * 2)),\n\n                cc.moveBy(deltaTime, cc.v2(0, offset * 2)),\n                cc.moveBy(deltaTime * 2, cc.v2(0, -offset * 4)),\n                cc.moveBy(deltaTime, cc.v2(0, offset * 2)),\n\n                cc.moveBy(deltaTime, cc.v2(offset, 0)),\n                cc.moveBy(deltaTime * 2, cc.v2(-offset * 2, 0)),\n                cc.moveBy(deltaTime, cc.v2(offset, 0)),\n\n                cc.moveBy(deltaTime, cc.v2(0, offset)),\n                cc.moveBy(deltaTime * 2, cc.v2(0, -offset * 2)),\n                cc.moveBy(deltaTime, cc.v2(0, offset)),\n            )\n        )\n    }\n\n    static fitScreen() {\n        var canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\n        var screenSize = cc.view.getVisibleSize();\n        if (screenSize.width / screenSize.height < 9 / 16) {\n            canvas.fitWidth = true;\n            canvas.fitHeight = false;\n        }\n        else {\n            canvas.fitWidth = false;\n            canvas.fitHeight = true;\n        }\n    }\n\n    public static resetScale(targetNode: cc.Node) {\n        var screenSize = cc.view.getVisibleSize();\n        if (screenSize.width / screenSize.height < 9 / 16) {\n            targetNode.scale = screenSize.width / 1080;//适配宽度\n        }\n        else {\n            targetNode.scale = screenSize.height / 1920;//适配高度\n        }\n    }\n\n\n    /**\n     * 显示广告(传入当前游戏名称，便于统计分类)\n     */\n    static showAD: (gameName) => {\n\n    }\n\n    static imgStr(str) {\n        return str;\n    }\n\n    static txtStr(str) {\n        return str;\n    }\n\n    //获取启动参数\n    static getLaunchParams() {\n        let parseParams = (str) => {\n            if (!str)\n                return null;\n            str = str.substr(1);\n            let params = {};\n            let arr = str.split(\"&\");\n            for (let i = 0; i < arr.length; i++) {\n                let kv = arr[i].split(\"=\");\n                params[kv[0]] = kv[1];\n            }\n            if (params.token && params.userId && params.gameId && params.serverHost)\n                return params;\n            else\n                return null;\n        };\n\n        if (cc.sys.isNative) {//内生平台\n            return null;\n        }\n        else if (Common_CommonUtil.isWeChat()) {//微信平台\n            let params = wx.getLaunchOptionsSync().query;\n            if (params.token && params.userId && params.gameId && params.serverHost)\n                return params;\n            return null;\n        }\n        else//h5通过url获取\n        {\n            let url = window.location.href;\n            var paramStr = null;\n            let startIndex = url.lastIndexOf(\"?\");\n            if (startIndex >= 0)\n                paramStr = url.substring(startIndex);\n            return parseParams(paramStr);\n        }\n    }\n\n    static preview() {\n        if (!Common_CommonUtil.isWeChat())\n            return;\n        wx.previewImage({\n            urls: [\"https://h5gameres.kuaiyugo.com/chatgame/cocos_games_res/images/codeImage.jpg\"]\n        });\n    }\n\n    /**\n    * 为节点或sprite设置SpriteFrame\n    * @param {string|cc.Node|cc.Sprite} obj node，sprite或其路径\n    * @param {string } imageUrl 资源路径\n    */\n    static setSprite(obj, imageUrl: string = \"\", callback: Function = null) {\n        if (!obj)\n            throw new Error(\"请传入正确的节点名称\");\n        if (!imageUrl)\n            throw new Error(\"请传入正确的资源路径\");\n        var spr;\n        if (obj instanceof cc.Sprite)                       //参数为Sprite\n            spr = obj;\n        else if (obj instanceof cc.Node)                    //参数为Node\n            spr = obj.getComponent(cc.Sprite);\n        else if (Object.prototype.toString.call(obj) === \"[object String]\")//参数为string(sprite所在Node的路径)\n            spr = cc.find(obj).getComponent(cc.Sprite);\n        else\n            throw new Error(\"传入节点资源类型不正确\");\n        if (!spr)\n            throw new Error(\"未找到正确的Sprite\");\n        if (!spr || !spr.spriteFrame)\n            return;\n        var opacity = spr.node.opacity;\n        spr.node.opacity = 0;\n        // cc.loader.loadRes(imageUrl, function (err, obj) {\n        //     if (err) {\n        //         cc.error(err.message || err);\n        //         return;\n        //     }\n        //     spr.spriteFrame = new cc.SpriteFrame(obj);\n        //     spr.node.opacity = opacity;\n        // });\n\n        let methodName = \"load\";\n        if (imageUrl.indexOf(\"http\") != 0)\n            methodName += \"Res\";\n        cc.loader[methodName](imageUrl, function (err, obj) {\n            if (err) {\n                cc.error(err.message || err);\n                return;\n            }\n            spr.spriteFrame = new cc.SpriteFrame(obj);\n            spr.node.opacity = opacity;\n            if (callback)\n                callback();\n        });\n    }\n\n    public static getPrefab(url: string, callback: Function) {\n        cc.loader.loadRes(url, (err, prefab) => {\n            if (err)\n                throw err;\n            callback(cc.instantiate(prefab));\n        })\n    }\n\n    public static setAvatarSprite(spriteOrNode, imgUrl) {\n        let sprite = null;\n        if (spriteOrNode instanceof cc.Sprite)\n            sprite = spriteOrNode;\n        else if (spriteOrNode instanceof cc.Node)\n            sprite = spriteOrNode.getComponent(cc.Sprite);\n\n        if (!sprite)\n            throw new Error(\"CommonUtil.setSprite:  无法找到正确的Sprite\");\n\n        let image = wx.createImage();\n        image.onload = function () {\n            let texture = new cc.Texture2D();\n            texture.initWithElement(image);\n            texture.handleLoadedTexture();\n            sprite.spriteFrame = new cc.SpriteFrame(texture);\n        };\n        image.src = imgUrl;\n    }\n}\n"]}